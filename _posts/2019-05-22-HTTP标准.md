---
layout: post
title: HTTP标准
tags: [网络]
---

HTTP标准

## HTTP标准

### HTTP1.0

规定浏览器和服务器之间只保持**短暂连接**，浏览器每次请求都需要和服务器建立一个TCP连接，服务器完成请求处理后断开TCP连接。
缺陷：
**连接无法复用**：如果一个网页文件中指明了多个js、css、图片等静态资源的地址，需要每多次请求和响应，即多次建立和关闭连接，影响客户端和服务端的性能。
浏览器客户端在同一时间，针对同一域名下的连接请求有一定数量限制。超过限制数目的请求会被阻塞。

### HTTP1.1

1. 支持持久连接(默认模式使用带流水线的持久连接)，在一个TCP连接上进行多次HTTP请求与响应，减少频繁建立和关闭连接的性能消耗。
一个包含多个静态资源的网页文件的多个请求和响应可以在一个TCP连接中传输，但每个单独的网页文件的请求和响应仍需使用各自的连接。
HTTP1.1允许客户端不用等待上一次请求结果返回就发出下一次请求，但服务端必须按照客户端请求的先后顺序依次返回响应结果。
request与response的header中的Connection:close，标识client或server不要使用长连接，任一方的header中包含了connection:close，请求处理完毕后，TCP连接会被断开。使用长连接则Connection:keep-alive。

2. HTTP1.0不支持Host请求头字段，1.1支持，Host请求头可以明确表示要访问服务器上哪一个域名。比如一台机器的Nginx上定义了多个server_name。

3. HTTP1.1支持断点续传，Range:bytes

4. 状态码：
1xx：指示信息--表示请求已接收，继续处理
2xx：成功--表示请求已被成功接收、理解、接受
3xx：重定向--要完成请求必须进行更进一步的操作
4xx：客户端错误--请求有语法错误或请求无法实现
5xx：服务器端错误--服务器未能实现合法的请求

5. **队头阻塞**：一列的第一个数据报（队头）受阻而导致整列数据报受阻。请求和响应需要在链接中有序执行，一次请求与响应的交互必须要等待前面的请求交互完成，否则后面的只能等待。

### HTTP2.0

1. **多路复用**：多路复用允许同时通过单一的HTTP/2连接发起多重的请求-响应消息。HTTP2.0把HTTP协议通信的基本单位缩小为一个一个的帧，对应逻辑流中的消息，并行地在同一个TCP连接上双向交换消息。
HTTP2.0在链接中并发地发送送多个请求，某个请求耗时严重不影响其他请求响应的正常执行。
2. **二级制分帧**：TCP协议数据的传输单位是*数据报*，分为header和body。HTTP2.0在应用层和传输层中间增加一个二进制分帧层，将数据报分割为帧，并二进制格式编码，header信息封装到header frame，request body封装到data frame。header帧和data帧可以分为多个片段帧。
*流*代表一个完成的请求-响应数据交互过程。
双向性：同一个流内，可以同时发送和接收数据；
有序性：流中被传输的数据就是二进制帧，无论发送还是接收都是按照顺序进行的；
并行性：流中的二进制帧并行传输，都有自己的顺序标号，最终按照顺序标号来合并；
流的创建：可与被客户端或服务器单方面建立；
流的关闭：可以被任意一方关闭。
3. **首部压缩**：使用专门为首部压缩而设计的HPACK算法
4. **服务端推送**：在 HTTP/2 中，服务器可以对客户端的一个请求发送多个响应。

### HTTPS

HTTP + SSL/TLS(HTTP与TCP之间) --> HTTPS
HTTPS在传输数据之前需要客户端和服务端进行一次握手，在握手过程中传输双方数据加密信息。

**握手过程**：
1. Hello - 客户端向服务器发送ClientHello信息，包含自己支持的密码套件；服务器响应中包含加密协议版本及加密算法，加密公钥和证书信息。
2. 证书验证 - 客户端验证服务器证书的合法性
3. 密钥交换 - 客户端生成一个用于对称加密算法的随机密钥，用Hello阶段确定的算法和公钥对其进行加密，发送到服务器，在服务器用私钥解密，服务器获得对称加密的密钥。
